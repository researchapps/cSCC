<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="text/html; charset=utf-8" http-equiv="content-type">
    <meta content="noindex, nofollow" name="robots">
    <meta content="noindex, nofollow" name="googlebot">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href='css/bootstrap.min.css' rel='stylesheet' type="text/css">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet">
    <title>cSCCscore: a Squamous Cell Skin Cancer Wed Prediction Tool</title>
     <!--  cSCCscore: a Squamous Cell Skin Cancer Wed Prediction Tool>
           Copyright (C) 2017  Vanessa Sochat-->
</head>
<body>
    <div class="container" style="padding-top:100px">
        <div class="row">
            <div class="col-md-1">
                <ul class="nav nav-pills nav-stacked red" style="margin-top:55px">
                    <li class="active" style="width:75px">
                        <a data-toggle="pill" href="#pill-calculate">History</a>
                    </li>
                    <li style="width:75px">
                        <a data-toggle="pill" href="#pill-about">About</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-10">
                <div class="tab-content">
                    <div class="tab-pane fade in active" id="pill-calculate">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="container" style="margin:0px 50px 50px 50px">
                                    <form class="form-horizontal">
                                        <fieldset>
                                            <legend style="margin-bottom:30px"> Squamous Cell Skin Cancer (cSCC) Web Prediction Tool.</legend> 

                                            <!-- Past Rx of Invasive: Prepended checkbox -->
                                            <div class="form-group" id="past_rx_invasive_div">
                                                <label class="col-md-3 control-label" for="past_rx_invasive">Patient History</label>
                                                <div class="col-md-8">
                                                    <p class="help-block">I have been diagnosed in the past with an invasive squamous cell skin cancer</p>
                                                    <div class="radio">
                                                        <label for="past_rx_invasive-0"><input class="past_rx_invasive" id="past_rx_invasive-0" name="past_rx_invasive" type="radio" value="1" required> True</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label for="past_rx_invasive-1"><input class="past_rx_invasive" id="past_rx_invasive-1" name="past_rx_invasive" type="radio" value="0" required> False</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr class="past_rx_invasive_div" style="display:none">

                                            <!-- Past Rx Insitu: Appended checkbox -->
                                            <div class="form-group" id="past_rx_insitu_div" style='display:none'>
                                                <label class="col-md-3 control-label" for="past_rx_insitu"></label>
                                                <div class="col-md-8">
                                                    <p class="help-block">I have been diagnosed in the past with a non-invasive (also called in-situ) squamous cell skin cancer</p>
                                                    <div class="radio">
                                                        <label for="past_rx_insitu-0"><input id="past_rx_insitu-0" name="past_rx_insitu" type="radio" value="1"> True</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label for="past_rx_insitu-1"><input id="past_rx_insitu-1" name="past_rx_insitu" type="radio" value="0"> False</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <hr>

                                            <!-- Past Rx Keratosis: Appended checkbox -->
                                            <div class="form-group" id="past_rx_keratosis_div">
                                                <label class="col-md-3 control-label" for="past_rx_keratosis"></label>
                                                <div class="col-md-8">
                                                    <p class="help-block">I have been diagnosed in the past with an actinic keratosis</p>
                                                    <div class="radio">
                                                        <label for="past_rx_keratosis-0"><input id="past_rx_keratosis-0" name="past_rx_keratosis" type="radio" value="1" required> True</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label for="past_rx_keratosis-1"><input id="past_rx_keratosis-1" name="past_rx_keratosis" type="radio" value="0" required> False</label>
                                                    </div> 
                                                </div>
                                            </div>
                                            <hr>

                                            <!-- Prepended checkbox -->
                                            <div class="form-group" id='genotyped_div'>
                                                <label class="col-md-3 control-label" for="genotyped">Genetic Risk</label>
                                                <div class="col-md-8">
                                                    <p class="help-block">I have been typed for the 
                                                    <a id="show-alleles-button" 
                                                       data-toggle="modal" 
                                                       style="cursor:pointer"
                                                       data-target="#alleles-modal">16 genetic variants</a> associated with increased risk of squamous cell skin cancer (to see the polymorphisms, click on "About")</p>
                                                    <div class="radio">
                                                        <label for="genotyped-0">
                                                            <input id="genotyped-0" 
                                                                   name="genotyped" 
                                                                   type="radio" 
                                                                   class="genotyped"
                                                                   value="1" required> True</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label for="genotyped-1">
                                                            <input id="genotyped-1" 
                                                                   name="genotyped" 
                                                                   type="radio" 
                                                                   class="genotyped" 
                                                                   value="0" required> False</label>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Risk Alleles: Select Basic -->
                                            <div class="form-group" id="risk_alleles_div" style="display:none">
                                                <label class="col-md-3 control-label" for="risk_alleles">The number of risk alleles that I carry is</label>
                                                <div class="col-md-3">
                                                    <select class="form-control" 
                                                            id="risk_alleles" name="risk_alleles">
                                                        <option value="0">
                                                            less than 8
                                                        </option>
                                                        <option value="1">
                                                            8 or 9
                                                        </option>
                                                        <option value="2">
                                                            10 or more
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>

                                            <!-- Genomic Risk: Select Basic -->
                                            <div class="form-group" id="genomic_risk_div">
                                                <label class="col-md-3 control-label" for="genomic_risk">Family History</label>
                                                <div class="col-md-8">
                                                    <p class="help-block">Based on the squamous cell skin cancer histories of my parents, siblings and children, my genetic risk for this cancer is</p><select class="form-control" id="genomic_risk" name="genomic_risk">
                                                        <option value="0"
                                                                selected="selected">
                                                            Low
                                                        </option>
                                                        <option value="1">
                                                            Moderate
                                                        </option>
                                                        <option value="2">
                                                            High
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
                                            <hr>
 
                                            <!-- Age in Years: Appended Input-->
                                            <div class="form-group" id="age_years_div">
                                                <label class="col-md-3 control-label" for="age_years">My current age is</label>
                                                <div class="col-md-3">
                                                    <div class="input-group">
                                                        <input class="form-control" id="age_years" name="age_years" placeholder="60" required="" type="text"> <span class="input-group-addon">years</span>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Gender: Multiple Radios -->
                                            <div class="form-group" id="gender_div">
                                                <label class="col-md-3 control-label" for="gender">My gender is</label>
                                                <div class="col-md-3">
                                                    <div class="radio">
                                                        <label for="gender-0"><input id="gender-0" name="gender" type="radio" value="male" required> Male</label>
                                                    </div>
                                                    <div class="radio">
                                                        <label for="gender-1"><input id="gender-1" name="gender" type="radio" value="female" required> Female</label>
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- Tendency Sunburn: Select Basic -->
                                            <div class="form-group" id="tendency_sunburn_div">
                                                <label class="col-md-3 control-label" for="tendency_sunburn">My tendency to sunburn is</label>
                                                <div class="col-md-3">
                                                    <select class="form-control" 
                                                            id="tendency_sunburn"
                                                            name="tendency_sunburn">
                                                        <option value="0" selected="selected">
                                                            Low
                                                        </option>
                                                        <option value="1">
                                                            Moderate
                                                        </option>
                                                        <option value="2">
                                                            High
                                                        </option>
                                                    </select>
                                                </div>
                                            </div>
 
                                             <!-- Calculate Button -->
                                            <div class="form-group">
                                                <label class="col-md-3 control-label" for="submit"></label>
                                                <div class="col-md-3">
                                                    <button class="btn btn-success" id="submit" name="submit">Calculate</button>
                                                </div>
                                            </div>

                                            <!-- Rx message -->
                                            <div class="form-group">
                                                <label class="col-md-3 control-label" for="submit"></label>
                                                <div class="col-md-8" id="message" style="display:none">
                                                    <p class="alert alert-info">Your chance of developing a new squamous cell skin cancer in the next 3 years is <span id="rx" style="font-weight:600"></span></p>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane fade in" id="pill-about">
                        <div class="container" style="margin:0px 50px 50px 50px">
                            <p class="well">Squamous cell skin cancers occur more frequently among people of non-Hispanic White race/ethnicity . If you are non-Hispanic white, this tool provides your estimated probability of developing a squamous cell skin cancer within the next three years.  For reference, one-third of a typical sample of non-Hispanic white men had risks less than 1.3%, one-third had risks between 1.3% and 5.0%, and the remaining men had risks greater than 5.0%.  The risks for non-Hispanic white women were lower: one-third were less than 0.8%, one third were between 0.8% and 2.3& and the remaining risks were greater than 2.3%.</p>
                            <legend>16 Polymorphisms Determining Genetic Risk</legend>
                            <p class="well">
If you have been genotyped for the 16 polymorphisms listed below, you can use your total number of risk alleles to determine your genetic risk for squamous cell skin cancers.</p>
                                <table>
        <thead>
            <tr>
                <th>Chromosomal Region</th>
                <th>Polymorphism</th>
                <th>Risk Allele</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1</td>
                <td>2p22.3</td>
                <td>rs192481803</td>
            </tr>
            <tr>
                <td>2</td>
                <td>3p13</td>
                <td>rs62246017</td>
            </tr>
            <tr>
                <td>3</td>
                <td>3q28</td>
                <td>rs6791479</td>
            </tr>
            <tr>
                <td>4</td>
                <td>5p13.2</td>
                <td>rs16891982</td>
            </tr>
            <tr>
                <td>5</td>
                <td>6p25.3</td>
                <td>rs12203592</td>
            </tr>
            <tr>
                <td>6</td>
                <td>6p21</td>
                <td>rs4455710</td>
            </tr>
            <tr>
                <td>7</td>
                <td>7p21.1</td>
                <td>rs117132860</td>
            </tr>
            <tr>
                <td>8</td>
                <td>9p22.2</td>
                <td>rs74664507</td>
            </tr>
            <tr>
                <td>9</td>
                <td>9q34.3</td>
                <td>rs57994353</td>
            </tr>
            <tr>
                <td>10</td>
                <td>11q23.3</td>
                <td>rs74899442</td>
            </tr>
            <tr>
                <td>11</td>
                <td>11q14.3</td>
                <td>rs1126809</td>
            </tr>
            <tr>
                <td>12</td>
                <td>15q13.1</td>
                <td>rs12916300</td>
            </tr>
            <tr>
                <td>13</td>
                <td>15q13.1</td>
                <td>rs1800407</td>
            </tr>
            <tr>
                <td>14</td>
                <td>16q24.3</td>
                <td>rs4268748</td>
            </tr>
            <tr>
                <td>15</td>
                <td>16q24.3</td>
                <td>rs1805007</td>
            </tr>
            <tr>
                <td>16</td>
                <td>20q11.22</td>
                <td>rs6059655</td>
            </tr>
        </tbody>
    </table>

                            <legend>What is this for?</legend>
                            <p class="well">This is a diagnosis tool intended to be used with a doctor.</p><legend>Who is involved?</legend>
                            <p class="well">The algorithm is developed by <a href="http://med.stanford.edu/hrp.html" target="_blank">Health Research and Policy</a> at the Stanford University School of Medicine. The web interface and associated code is maintained <a href="https://www.github.com/researchapps/cSCCscore">on Github</a> and you should <a href="https://www.github.com/researchapps/cSCCscore/issues">open an issue</a> if you have any questions.</p>
                            <div style="padding-top:50px; float:left">
                                <a href="https://srcc.stanford.edu" style="padding-right:30px" target="_blank"><img src="img/srcc.png" style="border-radius:5px; width:200px"></a> <a href="http://med.stanford.edu/hrp.html" target="_blank"><img src="img/stanford_medicine.png" style="border-radius:5px; width:250px"></a>
                            </div>
                            <p></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for SNP Table -->
    <div class="modal" id='alleles-modal'>
        <div class="modal-dialog" role="document">
            <div class="modal-content"  style="width:800px;height:800px">
                <div class="modal-body" id="alleles-body">
                    <iframe src="https://researchapps.github.io/cSCCscore/docs/table" 
                            width="800" height="760" 
                            frameborder="0" marginheight="0" 
                            marginwidth="0">Loading...</iframe>
                </div>
        </div>
      </div>
    </div>
   
    <script src="js/jquery-2.2.2.js" type="text/javascript"></script> 
    <script src='js/tether.min.js'></script> 
    <script src='js/lodash.min.js'></script> 
    <script src='js/bootstrap.min.js'></script> 
    <script type='text/javascript'>
    $(document).ready(function(){
      
      // If past rx invasive selected, non-invasive (in-situ) is changed to false, not required
      $(".past_rx_invasive").change(function(){
          
          if ($(this).val()==1) {
              $("#past_rx_insitu_div").hide();
              $(".past_rx_insitu_div").hide();
              $('input[name=past_rx_insitu]').prop('checked', false)
              $('input[name=past_rx_insitu]').prop('required', false)
          } else {
              $("#past_rx_insitu_div").show(); 
              $(".past_rx_insitu_div").show();
              $('input[name=past_rx_insitu]').prop('required', true)
          }

      })

      // If the patient hasn't been genotyped, ask for family history            
      $(".genotyped").change(function(){
      
          if ($('input[name=genotyped]').prop('checked')) {
              $("#risk_alleles_div").show();
              $("#genomic_risk_div").hide();
          } else {
              $("#risk_alleles_div").hide();
              $("#genomic_risk_div").show();
          }
      })
      
      // Main calculation goes here
      $("form").submit(function(e){

          e.preventDefault();

          var gender = $('input[name=gender]:checked').val();
          var age_years = parseInt($('input[name=age_years]').val());
          var sunburn_tendency = parseInt($('#tendency_sunburn').val());
          var past_rx_invasive = + $('input[name=past_rx_invasive]').prop('checked');

          var past_rx_insitu = 0;
          if (past_rx_invasive == 0){
              var past_rx_insitu = + $('input[name=past_rx_insitu]').prop('checked');
          }
          var past_rx_keratosis = + $('input[name=past_rx_keratosis]').prop('checked');

          // If genotyped, then use risk alleles
          if ($('input[name=genotyped]').prop('checked')) {
              var genomic_risk = parseInt($('#risk_alleles').find(":selected").val());

          // Otherwise use family history
          } else {
              var genomic_risk = parseInt($('#genomic_risk').find(":selected").val());
          }

          // Step 1: define variables based on gender.
          if (gender == "female"){

              // Female
              var B = [0.67, 0.08, 0.27, 0.16, 0.54, 1.74, 0.98, 1.51],
                  alpha0 = -10.50
                  alpha1 = 0.17
                  phi = 3.42;

          } else {

              // Male
              var B = [0.62, 0.09, 0.13, 0.30, 0.66, 1.80, 1.02, 1.37],
                  alpha0 = -9.89,
                  alpha1 = 0.17,
                  phi = 2.60;

          }

          console.log('Betas are ' + B);
          console.log('alpha0 ' + alpha0);
          console.log('alpha1 ' + alpha1);
          console.log('phi ' + phi);

          // Step 2: parse input for covariates
          var z1 = age_years/10.0;
          var z2 = + (sunburn_tendency==1); // moderate, + converts bool to int
          var z3 = + (sunburn_tendency==2); // high,
          var z4 = + (genomic_risk=="1")      // moderate genetic risk 
          var z5 = + (genomic_risk=="2")      // high genetic risk (either by way of alleles or report)
          var z6 = past_rx_keratosis        // 1 indicates past diagnosis of actinic keratosis
          var z7 = past_rx_insitu           // 1 indicates past diagnosis of non invasive (in-situ)
          var z8 = past_rx_invasive;        // 1 indicates past diagnosis of invasive carcinoma


          // Variable sanity check
          console.log('gender: ' + gender);
          console.log('age: ' + age_years);
          console.log('moderate sunburn tendency: ' + z2);
          console.log('high sunburn tendency: ' + z3);
          console.log('moderate genetic risk: ' + z4);
          console.log('high genetic risk: ' + z5);
          console.log('past_rx_invasive: ' + past_rx_invasive);
          console.log('past_rx_insitu: ' + past_rx_insitu);
          console.log('past_rx_keratosis: ' + past_rx_keratosis);

          var Z = [z1, z2, z3, z4, z5, z6, z7, z8]
          console.log('Z is ' + Z);

          // The output is the probability P of developing a squamous cell cancer in the next three years. P is given by
          var summation = 0
          $.each(new Array(8),function(i){ 
             summation+=(B[i]*Z[i]);
            }
          );

          console.log("Dot product of Z and B is " + summation);

          // Calculate assigned probability P of developing a new cancer in the next three years. 

          var inner_left = ((phi/alpha1) * (Math.exp(3*alpha1) - 1))
          console.log("Inner left ((phi/alpha1) * (Math.exp(3*alpha1) - 1)) is " + inner_left);

          var inner_right = Math.exp(alpha0+summation)
          console.log("Inner right Math.exp(alpha0+summation) is " + inner_right);

          var inner = 1 + (inner_left*inner_right)
          console.log("Inner 1 + (inner_left*inner_right) is " + inner);

          var exponent = -1*(1/phi)
          console.log("exponent -1*(1/phi) is " + exponent);

          var P = ((1 - (inner**exponent)) * 100).toFixed(2);
          console.log("P (1 - (inner**exponent)) * 100).toFixed(2) is " + P);

          // 2.2 Final Output to user:
          $("#rx").text(P + "%")
          $('#message').show();

      })


    })

    function showAlleles() {
        $("#alleles-body").append('<iframe src="https://researchapps.github.io/cSCCscore/docs/table" width="760" height="760" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>')
        $('#alleles-modal').modal('show');
    }
       
    </script>
</body>
</html>
